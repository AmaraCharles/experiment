(function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():e.Picker=t()})(this,function(){"use strict";function e(e){var t=document.createElement("div");return t.innerHTML=e,t.firstElementChild}function t(e,t){return(t||document).querySelector(e)}function o(e,t,o){e.addEventListener(t,o,!1)}function r(e){e.preventDefault(),e.stopPropagation()}function a(e,t){function r(e,t,o){return Math.max(t,Math.min(e,o))}function a(o,a,n){if(n&&(s=!0),s){o.preventDefault();var l=e.getBoundingClientRect(),i=l.width,c=l.height,d=a.clientX,u=a.clientY,p=r(d-l.left,0,i),g=r(u-l.top,0,c);t(p/i,g/c)}}function n(e,t){var o=void 0===e.buttons?e.which:e.buttons;1===o?a(e,e,t):s=!1}function l(e,t){1===e.touches.length?a(e,e.touches[0],t):s=!1}var s=!1;o(e,"mousedown",function(e){n(e,!0)}),o(e,"touchstart",function(e){l(e,!0)}),o(window,"mousemove",n),o(e,"touchmove",l),o(window,"mouseup",function(e){s=!1}),o(e,"touchend",function(e){s=!1}),o(e,"touchcancel",function(e){s=!1})}String.prototype.startsWith=String.prototype.startsWith||function(e){return 0===this.indexOf(e)},String.prototype.padStart=String.prototype.padStart||function(e,t){for(var o=this;o.length<e;)o=t+o;return o};var n=function(){function e(t,o,r,a){function n(t){function o(e){return e.match(/([\-\d\.e]+)/g).map(Number)}var r;if(t.startsWith("hsl")){var a=o(t),n=a[0],s=a[1],i=a[2];r=void 0===a[3]?1:a[3],n/=360,s/=100,i/=100,l.hsla([n,s,i,r])}else if(t.startsWith("rgb")){var c=o(t),d=c[0],u=c[1],p=c[2];r=void 0===c[3]?1:c[3],l.rgba([d,u,p,r])}else l.rgba(e.hexToRgb(t))}var l=this;if(void 0===t);else if(Array.isArray(t))this.rgba(t);else if(void 0===r){var s=t&&(""+t).trim();s&&n(s.toLowerCase())}else this.rgba([t,o,r,void 0===a?1:a])}var t=e.prototype;return t.rgba=function(t){if(!t){if(this._rgba)return this._rgba;if(!this._hsla)throw new Error("No color is set");return this._rgba=e.hslToRgb(this._hsla)}3===t.length&&(t[3]=1),this._rgba=t,this._hsla=null},t.rgbString=function(){return"rgb("+this.rgba().slice(0,3)+")"},t.rgbaString=function(){return"rgba("+this.rgba()+")"},t.hsla=function(t){if(!t){if(this._hsla)return this._hsla;if(!this._rgba)throw new Error("No color is set");return this._hsla=e.rgbToHsl(this._rgba)}3===t.length&&(t[3]=1),this._hsla=t,this._rgba=null},t.hslString=function(){var e=this.hsla();return"hsl("+360*e[0]+","+100*e[1]+"%,"+100*e[2]+"%)"},t.hslaString=function(){var e=this.hsla();return"hsla("+360*e[0]+","+100*e[1]+"%,"+100*e[2]+"%,"+e[3]+")"},t.hex=function(t){if(!t){var o=this.rgba(),r=o.map(function(e,t){return t<3?e.toString(16):Math.round(255*e).toString(16)});return"#"+r.map(function(e){return e.padStart(2,"0")}).join("")}this.rgba(e.hexToRgb(t))},e.hexToRgb=function(e){var t=(e.startsWith("#")?e.slice(1):e).replace(/^(\w{3})$/,"$1F").replace(/^(\w)(\w)(\w)(\w)$/,"$1$1$2$2$3$3$4$4").replace(/^(\w{6})$/,"$1FF");if(!t.match(/^([0-9a-fA-F]{8})$/))throw new Error("Unknown hex color: "+e);var o=t.match(/^(\w\w)(\w\w)(\w\w)(\w\w)$/).slice(1).map(function(e){return parseInt(e,16)});return o[3]=o[3]/255,o},e.rgbToHsl=function(e){var t=e[0],o=e[1],r=e[2],a=e[3];t/=255,o/=255,r/=255;var n,l,s=Math.max(t,o,r),i=Math.min(t,o,r),c=(s+i)/2;if(s===i)n=l=0;else{var d=s-i;switch(l=c>.5?d/(2-s-i):d/(s+i),s){case t:n=(o-r)/d+(o<r?6:0);break;case o:n=(r-t)/d+2;break;case r:n=(t-o)/d+4}n/=6}return[n,l,c,a]},e.hslToRgb=function(e){function t(e,t,o){return o<0&&(o+=1),o>1&&(o-=1),o<1/6?e+6*(t-e)*o:o<.5?t:o<2/3?e+(t-e)*(2/3-o)*6:e}var o,r,a,n=e[0],l=e[1],s=e[2],i=e[3];if(0===l)o=r=a=s;else{var c=s<.5?s*(1+l):s+l-s*l,d=2*s-c;o=t(d,c,n+1/3),r=t(d,c,n),a=t(d,c,n-1/3)}var u=[255*o,255*r,255*a].map(Math.round);return u[3]=i,u},window.__Color=e,e}(),l=function(){function l(e,t,r){o(e,p,function(e){t.indexOf(e.key)>=0&&r(e)})}function s(e){var t=this;this.settings={popup:"right",layout:"default",alpha:!0,editor:!0},this._openProxy=function(e){t.openHandler(e)},this.onChange=null,this.onDone=null,this.onOpen=null,this.onClose=null,this.setOptions(e)}var i="url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='2' height='2'%3E%3Cpath d='M1,0H0V1H2V2H1' fill='lightgrey'/%3E%3C/svg%3E\")",c=360,d="mousedown",u="focusin",p="keydown";document.documentElement.firstElementChild.appendChild(document.createElement("style")).textContent=".picker_wrapper.no_alpha .picker_alpha{display:none}.picker_wrapper.no_editor .picker_editor{position:absolute;z-index:-1;opacity:0}.layout_default.picker_wrapper{display:flex;flex-flow:row wrap;justify-content:space-between;align-items:stretch;font-size:10px;width:25em;padding:.5em}.layout_default.picker_wrapper input,.layout_default.picker_wrapper button{font-size:1rem}.layout_default.picker_wrapper>*{margin:.5em}.layout_default.picker_wrapper::before{content:'';display:block;width:100%;height:0;order:1}.layout_default .picker_slider,.layout_default .picker_selector{padding:1em}.layout_default .picker_hue{width:100%}.layout_default .picker_sl{flex:1 1 auto}.layout_default .picker_sl::before{content:'';display:block;padding-bottom:100%}.layout_default .picker_editor{order:1;width:6rem}.layout_default .picker_editor input{width:calc(100% + 2px);height:calc(100% + 2px)}.layout_default .picker_sample{order:1;flex:1 1 auto}.layout_default .picker_done{order:1}.picker_wrapper{box-sizing:border-box;background:#f2f2f2;box-shadow:0 0 0 1px silver;cursor:default;font-family:sans-serif;color:#444;pointer-events:auto}.picker_wrapper:focus{outline:none}.picker_wrapper button,.picker_wrapper input{margin:-1px}.picker_selector{position:absolute;z-index:1;display:block;transform:translate(-50%, -50%);border:2px solid white;border-radius:100%;box-shadow:0 0 3px 1px #67b9ff;background:currentColor;cursor:pointer}.picker_slider .picker_selector{border-radius:2px}.picker_hue{position:relative;background-image:linear-gradient(90deg, red, yellow, lime, cyan, blue, magenta, red);box-shadow:0 0 0 1px silver}.picker_sl{position:relative;box-shadow:0 0 0 1px silver;background-image:linear-gradient(180deg, white, rgba(255,255,255,0) 50%),linear-gradient(0deg, black, rgba(0,0,0,0) 50%),linear-gradient(90deg, gray, rgba(128,128,128,0))}.picker_alpha,.picker_sample{position:relative;background:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='2' height='2'%3E%3Cpath d='M1,0H0V1H2V2H1' fill='lightgrey'/%3E%3C/svg%3E\") left top/contain white;box-shadow:0 0 0 1px silver}.picker_alpha .picker_selector,.picker_sample .picker_selector{background:none}.picker_editor input{box-sizing:border-box;font-family:monospace;padding:.1em .2em}.picker_sample::before{content:'';position:absolute;display:block;width:100%;height:100%;background:currentColor}.picker_done button{box-sizing:border-box;padding:.2em .5em;cursor:pointer}.picker_arrow{position:absolute;z-index:-1}.picker_wrapper.popup{position:absolute;z-index:2;margin:1.5em}.picker_wrapper.popup,.picker_wrapper.popup .picker_arrow::before,.picker_wrapper.popup .picker_arrow::after{background:#f2f2f2;box-shadow:0 0 10px 1px rgba(0,0,0,0.4)}.picker_wrapper.popup .picker_arrow{width:3em;height:3em;margin:0}.picker_wrapper.popup .picker_arrow::before,.picker_wrapper.popup .picker_arrow::after{content:\"\";display:block;position:absolute;top:0;left:0;z-index:-99}.picker_wrapper.popup .picker_arrow::before{width:100%;height:100%;transform:skew(45deg);transform-origin:0 100%}.picker_wrapper.popup .picker_arrow::after{width:150%;height:150%;box-shadow:none}.popup.popup_top{bottom:100%;left:0}.popup.popup_top .picker_arrow{bottom:0;left:0;transform:rotate(-90deg)}.popup.popup_bottom{top:100%;left:0}.popup.popup_bottom .picker_arrow{top:0;left:0;transform:rotate(90deg) scale(1, -1)}.popup.popup_left{top:0;right:100%}.popup.popup_left .picker_arrow{top:0;right:0;transform:scale(-1, 1)}.popup.popup_right{top:0;left:100%}.popup.popup_right .picker_arrow{top:0;left:0}";var g=s.prototype;return g.setOptions=function(e){function t(e,t,o){for(var r in e)o&&o.indexOf(r)>=0||(t[r]=e[r])}if(e){var r=this.settings;if(e instanceof HTMLElement)r.parent=e;else{r.parent&&e.parent&&r.parent!==e.parent&&(r.parent.removeEventListener("click",this._openProxy,!1),this._popupInited=!1),t(e,r),e.onChange&&(this.onChange=e.onChange),e.onDone&&(this.onDone=e.onDone),e.onOpen&&(this.onOpen=e.onOpen),e.onClose&&(this.onClose=e.onClose);var a=e.color;a&&this._setColor(a)}var n=r.parent;n&&r.popup&&!this._popupInited?(o(n,"click",this._openProxy),l(n,[" ","Spacebar","Enter"],this._openProxy),this._popupInited=!0):e.parent&&!r.popup&&this.show()}},g.openHandler=function(e){if(this.show()){e&&e.preventDefault(),this.settings.parent.style.pointerEvents="none";var t=e&&e.type===p?this._domEdit:this.domElement;setTimeout(function(){t.focus()},100),this.onOpen&&this.onOpen(this.color)}},g.closeHandler=function(e){var t=this.settings.parent,o=e&&e.type,a=!1;e?o===d||o===u?this.domElement.contains(e.target)||(a=!0):(r(e),a=!0):a=!0,a&&this.hide()&&(t.style.pointerEvents="",o!==d&&t.focus(),this.onClose&&this.onClose(this.color))},g.movePopup=function(e,t){this.closeHandler(),this.setOptions(e),t&&this.openHandler()},g.setColor=function(e,t){this._setColor(e,{silent:t})},g._setColor=function(e,t){if("string"==typeof e&&(e=e.trim()),e){var o;t=t||{};try{o=new n(e)}catch(e){if(t.failSilently)return;throw e}if(!this.settings.alpha){var r=o.hsla();r[3]=1,o.hsla(r)}this.color=o,this._setHSLA(null,null,null,null,t)}},g.show=function(){var o=this.settings;if(!o.parent)return!1;if(this.domElement){var r=this._toggleDOM(!0);return this._setPosition(),r}var a=o.template||'<div class="picker_wrapper" tabindex="-1"><div class="picker_arrow"></div><div class="picker_hue picker_slider"><div class="picker_selector"></div></div><div class="picker_sl"><div class="picker_selector"></div></div><div class="picker_alpha picker_slider"><div class="picker_selector"></div></div><div class="picker_editor"><input aria-label="Type a color HEX, RGB or HSL value"/></div><div class="picker_sample"></div><div class="picker_done"><button>Ok</button></div></div>',n=e(a);return this.domElement=n,this._domH=t(".picker_hue",n),this._domSL=t(".picker_sl",n),this._domA=t(".picker_alpha",n),this._domEdit=t(".picker_editor input",n),this._domSample=t(".picker_sample",n),this._domOkay=t(".picker_done button",n),n.classList.add("layout_"+o.layout),o.alpha||n.classList.add("no_alpha"),o.editor||n.classList.add("no_editor"),this._ifPopup(function(){n.classList.add("popup")}),this._setPosition(),this.color?this._updateUI():this._setColor("#0cf"),this._bindEvents(),!0},g.hide=function(){return this._toggleDOM(!1)},g._bindEvents=function(){function e(e){r._ifPopup(function(){r.closeHandler(e)})}function t(e){r._ifPopup(function(){r.closeHandler(e)}),r.onDone&&r.onDone(r.color)}var r=this,n=this.domElement;o(n,"click",function(e){e.preventDefault()}),a(this._domH,function(e,t){r._setHSLA(e)}),a(this._domSL,function(e,t){r._setHSLA(null,e,1-t)}),this.settings.alpha&&a(this._domA,function(e,t){r._setHSLA(null,null,null,1-t)});var s=this._domEdit;o(s,"input",function(e){r._setColor(this.value,{fromEditor:!0,failSilently:!0})}),o(s,"focus",function(e){var t=this;t.selectionStart===t.selectionEnd&&t.select()}),o(window,d,e),o(window,u,e),l(n,["Esc","Escape"],e),o(this._domOkay,"click",t),l(n,["Enter"],t)},g._setPosition=function(){var e=this.settings.parent,t=this.domElement;e!==t.parentNode&&e.appendChild(t),this._ifPopup(function(o){"static"===getComputedStyle(e).position&&(e.style.position="relative");var r=!0===o?"popup_right":"popup_"+o;["popup_top","popup_bottom","popup_left","popup_right"].forEach(function(e){e===r?t.classList.add(e):t.classList.remove(e)}),t.classList.add(r)})},g._setHSLA=function(e,t,o,r,a){a=a||{};var n=this.color,l=n.hsla();[e,t,o,r].forEach(function(e,t){(e||0===e)&&(l[t]=e)}),n.hsla(l),this._updateUI(a),this.onChange&&!a.silent&&this.onChange(n)},g._updateUI=function(e){function o(e,t,o){t.style.left=100*o+"%"}function r(e,t,o){t.style.top=100*o+"%"}if(this.domElement){e=e||{};var a=this.color,n=a.hsla(),l="hsl("+n[0]*c+", 100%, 50%)",s=a.hslString(),d=a.hslaString(),u=this._domH,p=this._domSL,g=this._domA,h=t(".picker_selector",u),b=t(".picker_selector",p),f=t(".picker_selector",g);o(u,h,n[0]),this._domSL.style.backgroundColor=this._domH.style.color=l,o(p,b,n[1]),r(p,b,1-n[2]),p.style.color=s,r(g,f,1-n[3]);var m=s,k=m.replace("hsl","hsla").replace(")",", 0)"),w="linear-gradient("+[m,k]+")";if(this._domA.style.backgroundImage=w+", "+i,!e.fromEditor){var y=a.hex();this._domEdit.value=this.settings.alpha?y:y.substr(0,7)}this._domSample.style.color=d}},g._ifPopup=function(e,t){var o=this.settings;o.parent&&o.popup?e&&e(o.popup):t&&t()},g._toggleDOM=function(e){var t=this.domElement;if(!t)return!1;var o=e?"":"none",r=t.style.display!==o;return r&&(t.style.display=o),r},s}();return l}),function(){var e=function(e,t){return function(o){return o.replace(e,t)}},t=/((\n\t)(.*))+/g,o=/(`)(.*?)\1/g,r=/(?:!\[(.*?)\]\((.*?)\))/g,a=/\[([^\[]+)\]\(([^\)]+)\)/g,n=/\n(#+\s*)(.*)/g,l=/(\*{1,2})(.*?)\1/g,s=/(\~\~)(.*?)\1/g,i=/\n(&gt;|\>)(.*)/g,c=/\n((\-{3,})|(={3,}))/g,d=/(\n\s*(\-|\+)\s.*)+/g,u=/(\n\s*([0-9]+\.)\s.*)+/g,p=/\n+(?!<pre>)(?!<h)(?!<ul>)(?!<blockquote)(?!<hr)(?!\t)([^\n]+)\n/g,g=function(e){return"\n<pre>"+e+"</pre>"},h=function(e,t,o){return"<code>"+o+"</code>"},b=function(e,t,o){return t=t||"",'<img src="'+o+'" alt="'+t+'" />'},f=function(e,t,o){return'<a href="'+o+'">'+t+"</a>"},m=function(e,t,o){return"\n<h"+t.trim().length+">"+o+"</h"+t.trim().length+">"},k=function(e,t,o){return"<"+(1==t.trim().length?"em":"strong")+">"+o+"</"+(1==t.trim().length?"em":"strong")+">"},w=function(e,t,o){return"<del>"+o+"</del>"},y=function(e,t,o){return"\n<blockquote>"+o+"</blockquote>"},v=function(e){return"\n<hr />"},_=function(e){var t="";return e.trim().split("\n").forEach(function(e){t+="<li>"+e.substring(2)+"</li>"}),"\n<ul>"+t+"</ul>"},S=function(e){var t="";return e.trim().split("\n").forEach(function(e){t+="<li>"+e.substring(e.indexOf(".")+2)+"</li>"}),"\n<ol>"+t+"</ol>"},C=function(e,t){return t},x=e(t,g),T=e(o,h),N=e(r,b),q=e(a,f),L=e(n,m),A=e(l,k),E=e(s,w),M=e(i,y),P=e(c,v),B=e(d,_),O=e(u,S),D=e(p,C),F=/\n(<pre>)((\n|.)*)(<\/pre>)/g,H=function(e,t,o,r,a){var n="";return o.split("\n").forEach(function(e){n+=e.substring(1)+"\n"}),t+n+a},Y=e(F,H),I=function(e){return D(O(B(P(M(E(A(L(q(N(T(x(e))))))))))))};window.parseMarkdown=function(e){return Y(I("\n"+e+"\n")).trim()}}(),function(){function e(e,t){for(var o in e)if(o.startsWith("__reactInternalInstance$")||o.startsWith("__reactFiber$")){res=e[o];try{if(e[o]._currentElement){var r=e[o]._currentElement,a=r._owner,n=a._instance;res=n}else if(e[o].child&&e[o].child.props&&"not_child"!==t)res=e[o].child;else if(e[o].child&&e[o].child.pendingProps&&"not_child"!==t)res=e[o].child;else if(e[o].pendingProps){var l=e[o].pendingProps.children._owner?e[o].pendingProps.children._owner.stateNode:e[o].pendingProps.children[0]&&e[o].pendingProps.children[0]._owner?e[o].pendingProps.children[0]._owner.stateNode:e[o].return.stateNode?e[o].return.stateNode:null;l&&(res=l)}else if(e[o].memoizedProps){var s=e[o].memoizedProps.children._owner?e[o].memoizedProps.children._owner.stateNode:e[o].memoizedProps.children[0]&&e[o].memoizedProps.children[0]._owner?e[o].memoizedProps.children[0]._owner.stateNode:e[o].return.stateNode?e[o].return.stateNode:null;s&&(res=s)}}catch(e){console.log(e)}return res}return null}function t(e){var t=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(String(e).toLowerCase())}function o(e){if(e+="",null==e.match(/\.(jpeg|jpg|gif|png)$/)&&null==e.match("https://static1.squarespace.com/")&&null==e.match("https://images.squarespace-cdn.com/")||-1!=e.indexOf("<img")){var t=document.createElement("a");t.href=e;var o=t.host&&t.host!=window.location.host;return t=null,o}return"image"}function r(e,t,o){if("number"!=typeof e||e<-1||e>1||"string"!=typeof t||"r"!=t[0]&&"#"!=t[0]||o&&"string"!=typeof o)return null;this.sbcRip||(this.sbcRip=function(e){var t=e.length,o={};if(t>9){if(e=e.split(","),e.length<3||e.length>4)return null;o[0]=r(e[0].split("(")[1]),o[1]=r(e[1]),o[2]=r(e[2]),o[3]=e[3]?parseFloat(e[3]):-1}else{if(8==t||6==t||t<4)return null;t<6&&(e="#"+e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+(t>4?e[4]+""+e[4]:"")),e=r(e.slice(1),16),o[0]=e>>16&255,o[1]=e>>8&255,o[2]=255&e,o[3]=-1,9!=t&&5!=t||(o[3]=a(o[2]/255*1e4)/1e4,o[2]=o[1],o[1]=o[0],o[0]=e>>24&255)}return o});var r=parseInt,a=Math.round,n=t.length>9,l=(n="string"==typeof o?o.length>9||"c"==o&&!n:n,e<0),s=(e=l?-1*e:e,o=o&&"c"!=o?o:l?"#000000":"#FFFFFF",this.sbcRip(t)),i=this.sbcRip(o);return s&&i?n?"rgb"+(s[3]>-1||i[3]>-1?"a(":"(")+a((i[0]-s[0])*e+s[0])+","+a((i[1]-s[1])*e+s[1])+","+a((i[2]-s[2])*e+s[2])+(s[3]<0&&i[3]<0?")":","+(s[3]>-1&&i[3]>-1?a(1e4*((i[3]-s[3])*e+s[3]))/1e4:i[3]<0?s[3]:i[3])+")"):"#"+(4294967296+16777216*a((i[0]-s[0])*e+s[0])+65536*a((i[1]-s[1])*e+s[1])+256*a((i[2]-s[2])*e+s[2])+(s[3]>-1&&i[3]>-1?a(255*((i[3]-s[3])*e+s[3])):i[3]>-1?a(255*i[3]):s[3]>-1?a(255*s[3]):255)).toString(16).slice(1,s[3]>-1||i[3]>-1?void 0:-2):null}function a(e,t,o){var r;return function(){var a=this,n=arguments,l=function(){r=null,o||e.apply(a,n)},s=o&&!r;clearTimeout(r),r=setTimeout(l,t),s&&e.apply(a,n)}}function n(e){for(var t=e.querySelectorAll(".row-header-shim"),o=e.querySelectorAll(".softmerge-inner"),r=e.tHead||e.querySelector("thead"),a=e.rows||e.querySelectorAll("tbody tr"),n=o.length-1;n>=0;n--)o[n].parentNode.innerHTML=o[n].innerHTML;for(var l=t.length-1;l>=0;l--)t[l].parentNode.removeChild(t[l]);if(a[0]){r.innerHTML="";for(var s=D.cloneNode(!1),i=a[0].cells||a[0].querySelectorAll("td"),c=0;c<i.length;c++){var d=F.cloneNode(!1);d.className="table-header-th",d.colSpan=i[c].colSpan,d.className+=0===c?" table-label":" table-header-not-label",i[c].className&&(d.className+=" "+i[c].className),d.innerHTML=i[c].innerHTML,s.appendChild(d)}a[0].parentNode.removeChild(a[0]),r.appendChild(s)}for(l=a.length-1;l>=0;l--){a[l].style&&a[l].removeAttribute("style"),a[l].className+=" table-row table-row-"+l;var u=a[l].cells||a[l].querySelectorAll("td");if(u&&u.length)for(var p=0;p<u.length;p++)u[p].className+=" table-cell table-cell-"+(p+1)}return e.innerHTML}function l(e,t){var o=O.cloneNode(!1);if(o.className="custom-table-block",e.tableDefClasses&&(o.setAttribute("data-def-classes",e.tableDefClasses),o.className+=" "+e.tableDefClasses),e.tableClasses&&(o.setAttribute("data-classes",e.tableClasses),o.className+=" "+e.tableClasses),e.googleKey&&o.setAttribute("data-gss-key",e.googleKey),e.mobileStyles&&o.setAttribute("data-mobile-styles",e.mobileStyles),e.sortTable&&o.setAttribute("data-table-sort",!0),o.setAttribute("data-table-back",e.tableBack),o.setAttribute("data-header-back",e.headerBack),o.setAttribute("data-header-color",e.headerColor),o.setAttribute("data-table-color",e.tableColor),o.setAttribute("data-borders-color",e.bordersColor),o.setAttribute("data-gss-sync",!!e.googleSync),o.setAttribute("data-follow-gss-styles",!!e.followGStyles),o.setAttribute("data-auto-detect-links",!!e.autodetectLinks),o.setAttribute("data-disable-markdown",!!e.disableMarkdown),e.followTable){if(o.innerHTML=n(e.followTable.cloneNode(!0)),e.autodetectLinks)for(var r=o.querySelectorAll("th,td"),a=r.length-1;a>=0;a--)r[a].innerHTML=s(r[a].innerHTML,!0)}else{h(e,o);g(e,o)}return Array.prototype.slice.call(o.querySelectorAll("a[href]")).forEach(function(e){if(e.href.indexOf("https://www.google.com/url?q=")>-1){var t=e.search.substring(1);try{var o=JSON.parse('{"'+t.replace(/&/g,'","').replace(/=/g,'":"')+'"}',function(e,t){return""===e?t:decodeURIComponent(t.replace(/\+/g," "))});o&&o.q&&(e.href=o.q)}catch(e){console.warn(e)}}}),o.outerHTML}function s(e,r){if(e&&r){var a=o(e);if(a)return"image"===a?'<img src="'+e+'"/>':'<a target="_blank" href="'+e+'">'+e+"</a>";if(t(e))return'<a href="mailto:'+e+'">'+e+"</a>"}return e}function d(e){var t=e.querySelector("thead .table-label")?e.querySelector("thead .table-label").innerHTML.replace(/data-preserve-html-node="true"/g,""):"",o=Array.prototype.slice.call(e.querySelectorAll("thead .table-header-not-label"));o.length&&o.map(function(e,t){o[t]=e.innerHTML.replace(/data-preserve-html-node="true"/g,"")});var r=Array.prototype.slice.call(e.querySelectorAll(".first-cell"));r.length&&r.map(function(e,t){r[t]=e.innerHTML.replace(/data-preserve-html-node="true"/g,"")});var a=Array.prototype.slice.call(e.querySelectorAll(".table-row"));a.length&&a.map(function(e,t){a[t]=[];var o=Array.prototype.slice.call(e.querySelectorAll(".next-cell"));o.length&&o.map(function(e){a[t].push(e.innerHTML.replace(/data-preserve-html-node="true"/g,""))})});var n={data:a,seriesLabels:o,sampleLabels:r,labelName:t,googleSync:"true"==e.getAttribute("data-gss-sync"),followGStyles:"true"==e.getAttribute("data-follow-gss-styles"),autodetectLinks:"true"==e.getAttribute("data-auto-detect-links"),googleKey:e.getAttribute("data-gss-key"),tableClasses:e.getAttribute("data-classes"),tableDefClasses:e.getAttribute("data-def-classes"),mobileStyles:e.getAttribute("data-mobile-styles"),sortTable:e.getAttribute("data-table-sort"),tableBack:e.getAttribute("data-table-back"),headerBack:e.getAttribute("data-header-back"),headerColor:e.getAttribute("data-header-color"),tableColor:e.getAttribute("data-table-color"),bordersColor:e.getAttribute("data-borders-color"),disableMarkdown:e.getAttribute("data-disable-markdown")};return n}function u(e,t){for(var o in t)t.hasOwnProperty(o)&&("class"==o?e.className+=" "+t[o]:e.setAttribute(o,t[o]))}function g(e,t){for(var o=e.data,r=0,a=o.length;r<a;++r){var n=D.cloneNode(!1);n.className="table-row table-row-"+r;var l=[].concat(o[r]);l&&l.unshift(e.sampleLabels[r]);for(var i=0,c=l.length;i<c;++i){var d=I.cloneNode(!1),p=l[i]||"",g="";if(p.indexOf("|*")>-1){try{g=p.split("|*")[1],g&&(g=JSON.parse("{"+g.substring(0,g.length-1)+"}"))}catch(e){console.log(e)}p=p.split("|*")[0]}d.className="table-cell table-cell-"+(i+1),d.className+=0===i?" first-cell":" next-cell",g&&u(d,g),d.innerHTML=s(p,e.autodetectLinks),n.appendChild(d)}t.appendChild(n)}}function h(e,t){var o=H.cloneNode(!1),r=[].concat(e.seriesLabels);r[0]!==e.labelName&&r.unshift(e.labelName);try{for(var a=0,n=r.length;a<n;a++){var l=F.cloneNode(!1),i="";if(r[a]&&r[a].indexOf("|*")>-1){try{i=r[a].split("|*")[1],i&&(i=JSON.parse("{"+i.substring(0,i.length-1)+"}"))}catch(e){console.log(e)}r[a]=r[a].split("|*")[0]}l.className="table-header-th",l.className+=0===a?" table-label":" table-header-not-label",i&&u(l,i),l.innerHTML=s(r[a],e.autodetectLinks),o.appendChild(l)}}catch(e){console.log(e)}t.appendChild(o)}function b(e){var t=/[\/&=?#]+/gi;e=e.replace(t,"index.html").split("index.html");return e.sort(function(e,t){return t.length-e.length}),e[0].length>=44&&e.indexOf("https://docs.google.com/spreadsheets/d/")>-1?e:e[0]}function m(e){return!(!e.match(/[0-9a-z_-]{44}/gi)||44!==e.length)||e.indexOf("https://docs.google.com/spreadsheets/d/")>-1}function w(e){return m(e)?e:e.length>=44?b(e):(console.log("Invalid key or URL:\n\n"+e),!1)}function y(e){if(e&&e.currentTarget){var t=e.currentTarget,o=t.getName();switch(t.once("rendered",function(){"editor-block-markdown"!=t.getName()&&"editor-block-custom-tables"!=t.getName()||(window.customTable||t.anchorEl.one(".custom-table-block"))&&_(t,!0)}),o){case"editor-block-custom-table":_(t,!1)}}}function v(e){return e.ownerDocument.defaultView?e.ownerDocument.defaultView:e.ownerDocument.parentWindow}function _(e,t){var o=function(){if(e.el&&e.el.addClass("custom-table-block-edit"),e.params&&e.params.tabs){e.params.tabs[0].title="Table";var t=e.anchorEl;t.one(".table-stylesheet")&&t.one(".table-stylesheet").remove();Y.Squarespace.Damask.ContextGlobals.fromFrame("Y");var o,r,n=v(t._node).Y.Widget.getByNode(t),s=(n.get("model"),{data:[["8 537 673","4 042 000"],["10 831 100","3 198 000"]],seriesLabels:["Population, million","Density, men/km<sup>2</sup>"],sampleLabels:["New York","Los Angeles"],labelName:"City",googleSync:!1,autodetectLinks:!1,googleKey:"",tableClasses:""});if(t.one(".custom-table-block thead")&&(s=d(t.one(".custom-table-block").getDOMNode())),e.params.tabs[0].tabFields.forEach(function(e){e.type&&"wysiwyg"==e.type&&e.editor&&(o=e.editor,e.generateHTML=function(e){return e},e.hide()),e.name&&"DescriptionField"==e.name&&e.setText('Add your dataset to table<br/><a target="_blank" href="https://www.squarewebsites.org/products/custom-table-block">More Info</a>')}),!e.params.tabs[0].tabPanelObj.one(".name-custom-dataTable")){var i=null,c=!0,u=function(e,t,o){for(var r=e[0].splice(0,1),a=e[0],n=[],l=[],s=1,d=e.length;s<d;++s)n.push(e[s].splice(0,1)[0]),e[s]&&e[s].length&&l.push(e[s]);var u={data:l,seriesLabels:a,sampleLabels:n,labelName:r+""};c=!0,O.set("data",u),O.populateTable(u),O.google_css=o,i()},p=function(e){if(e=e.target?e.target.result:e,e)if(e.indexOf("<!DOCTYPE html>")>-1){var t=x(e),o=document.createElement("div");o.innerHTML=e,r=o.querySelector("table");var a=o.querySelector("style")&&o.querySelector("style").textContent;(!a||a&&-1==a.indexOf(".ritz "))&&(a=!1),t?u(t,r,a):console.log("Empty or malformed file!")}else try{var n=e&&e.csvToArray();r=null,n.length?u(n):(console.log("Empty data to parse"),new Y.Squarespace.Widgets.Alert({"strings.title":"Warning","strings.message":"Empty data to parse."}))}catch(e){console.log(e),new Y.Squarespace.Widgets.Alert({"strings.title":"Warning","strings.message":"Empty data to parse."})}else console.log("Empty data to parse"),new Y.Squarespace.Widgets.Alert({"strings.title":"Warning","strings.message":"Empty data to parse."})},g=new Y.Squarespace.DialogFields.Select({name:"custom-table-def-class","strings.title":"Select table style.","strings.description":"Select base table style.",defaultValue:s.tableDefClasses?s.tableDefClasses:"custom-table-block-bordered",options:[{label:"Bordered",value:"custom-table-block-bordered"},{label:"Full Width",value:"custom-table-block-full-width"},{label:"Fixed Width, try this if overlapping content",value:"custom-table-block-fixed-width"},{label:"Horizontal",value:"custom-table-block-horizontal"},{label:"Even Rows",value:"custom-table-block-even-rows"},{label:"Odd Rows",value:"custom-table-block-odd-rows"},{label:"Highlight Rows",value:"custom-table-block-highlight-rows"},{label:"Center Table",value:"custom-table-block-center"},{label:"Right Align Table",value:"custom-table-block-right"},{label:"Center Table Content",value:"custom-table-block-center-content"}]});g.after("dataChange",function(e){i()}),g.render(e.params.tabs[0].tabPanelObj);var h=new Y.Squarespace.DialogFields.AutoComplete({"strings.title":"Add custom class to your table.","strings.description":"This helps you to style a table.","strings.placeholder":"custom-table-block-full-width",data:s.tableClasses,acConfig:{source:["custom-table-block-center","custom-table-block-center-content","custom-table-block-bordered","custom-table-block-full-width","custom-table-block-horizontal","custom-table-block-even-rows","custom-table-block-odd-rows","custom-table-block-highlight-rows"],resultFilters:"phraseMatch",zIndex:1e6}});h.after("dataChange",function(e){i()}),h.render(e.params.tabs[0].tabPanelObj);var b='<div class="color-input" style="height:42px;width:42px;position:absolute;bottom:0;right:0;border:1px solid #333"></div>',f=new Y.Squarespace.DialogFields.TextField({name:"custom-table-background",data:s.tableBack||"#ffffff","strings.title":"Set Table background color","strings.description":"","strings.placeholder":"#ffffff"});f.after("dataChange",function(e){i&&i()}),f.after("render",function(e){try{e.currentTarget._childrenContainer&&e.currentTarget._childrenContainer.setStyle("position","relative")&&e.currentTarget._childrenContainer.append(b);var t=e.currentTarget._childrenContainer.one(".color-input")._node;new Picker({parent:t,popup:"left",color:s.tableBack||"#fff",alpha:!0,onChange:function(e){t.style.background=e.rgbaString(),f.set("data",e.rgbaString())},onDone:function(e){t.style.backgroundColor=e.rgbaString()}})}catch(e){console.log(e)}}),f.render(e.params.tabs[0].tabPanelObj);var k=new Y.Squarespace.DialogFields.TextField({name:"custom-table-header-background",data:s.headerBack||"#e0e0e0","strings.title":"Set Table Header background color","strings.description":"","strings.placeholder":"#e0e0e0"});k.after("dataChange",function(e){i&&i()}),k.after("render",function(e){try{e.currentTarget._childrenContainer&&e.currentTarget._childrenContainer.setStyle("position","relative")&&e.currentTarget._childrenContainer.append(b);var t=e.currentTarget._childrenContainer.one(".color-input")._node;new Picker({parent:t,popup:"left",color:s.headerBack||"#e0e0e0",alpha:!0,onChange:function(e){t.style.background=e.rgbaString(),k.set("data",e.rgbaString())},onDone:function(e){t.style.backgroundColor=e.rgbaString()}})}catch(e){console.log(e)}}),k.render(e.params.tabs[0].tabPanelObj);var y=new Y.Squarespace.DialogFields.TextField({name:"custom-table-header-color",data:s.headerBack||"#000000","strings.title":"Set Table Header text color","strings.description":"","strings.placeholder":"#000000"});y.after("dataChange",function(e){i&&i()}),y.after("render",function(e){try{e.currentTarget._childrenContainer&&e.currentTarget._childrenContainer.setStyle("position","relative")&&e.currentTarget._childrenContainer.append(b);var t=e.currentTarget._childrenContainer.one(".color-input")._node;new Picker({parent:t,popup:"left",color:s.headerColor||"#000000",alpha:!0,onChange:function(e){t.style.background=e.rgbaString(),y.set("data",e.rgbaString())},onDone:function(e){t.style.backgroundColor=e.rgbaString()}})}catch(e){console.log(e)}}),y.render(e.params.tabs[0].tabPanelObj);var _=new Y.Squarespace.DialogFields.TextField({name:"custom-table-background",data:s.tableColor||"#000000","strings.title":"Set Table Body text color","strings.description":"","strings.placeholder":"#000000"});_.after("dataChange",function(e){i&&i()}),_.after("render",function(e){try{e.currentTarget._childrenContainer&&e.currentTarget._childrenContainer.setStyle("position","relative")&&e.currentTarget._childrenContainer.append(b),e.currentTarget._textField&&e.currentTarget._textField.set;var t=e.currentTarget._childrenContainer.one(".color-input")._node;new Picker({parent:t,popup:"left",color:s.tableColor||"#000000",alpha:!0,onChange:function(e){t.style.background=e.rgbaString(),_.set("data",e.rgbaString())},onDone:function(e){t.style.backgroundColor=e.rgbaString()}})}catch(e){console.log(e)}}),_.render(e.params.tabs[0].tabPanelObj);var C=new Y.Squarespace.DialogFields.TextField({name:"custom-table-background",data:s.bordersColor||"#cbcbcb","strings.title":"Set Table Borders color","strings.description":"","strings.placeholder":"#cbcbcb"});C.after("dataChange",function(e){i&&i()}),C.after("render",function(e){try{e.currentTarget._childrenContainer&&e.currentTarget._childrenContainer.setStyle("position","relative")&&e.currentTarget._childrenContainer.append(b),e.currentTarget._textField&&e.currentTarget._textField.set;var t=e.currentTarget._childrenContainer.one(".color-input")._node;new Picker({parent:t,popup:"left",color:s.bordersColor||"#cbcbcb",alpha:!0,onChange:function(e){t.style.background=e.rgbaString(),C.set("data",e.rgbaString())},onDone:function(e){t.style.backgroundColor=e.rgbaString()}})}catch(e){console.log(e)}}),C.render(e.params.tabs[0].tabPanelObj);var T=new Y.Squarespace.DialogFields.TextField({name:"custom-gss-url",data:s.googleKey,"strings.title":"Paste  your public Google Spreadsheet URL or key.","strings.description":'Make sure you made your sheet public.<br/><strong style="color:red">And preffered way is html shared link, use <i>File -> Publish on web -> as Webpage</i></strong><br/><span style="color:red">For big Google Spreasheets <strong>you\'d better use CSV shared link - usually ends with <i>?output=csv</i></strong></span>',"strings.placeholder":"https://docs.google.com/spreadsheets/d/****/pubhtml"});T.after("change",function(e){var t=e.target.get("data")?e.target.get("data").trim():"";D(t),t.indexOf("/pubhtml")>-1?N&&N.show():N&&N.hide()}),T.render(e.params.tabs[0].tabPanelObj);var N=new Y.Squarespace.DialogFields.Check({name:"custom-table-follow-g-styles","strings.title":"Follow Google Sheet Styling (font, colors, some sizes)","strings.description":'<strong style="color:red">If checked, the Table will apply Google styling - it work for Webpage-shared links only (those that ends with /pubhtml).<strong>',visible:T.get("data")&&T.get("data").indexOf("/pubhtml")>-1,data:s.followGStyles});N.after("dataChange",function(e){i()}),N.render(e.params.tabs[0].tabPanelObj);var q=new Y.Squarespace.DialogFields.Check({name:"custom-table-sync-gss","strings.title":"Sync Google Spreadsheet?","strings.description":"If checked, table will be updated on each page load",data:s.googleSync});q.after("dataChange",function(e){s.googleKey&&s.googleSync?D(s.googleKey):i()}),q.render(e.params.tabs[0].tabPanelObj);var L=new Y.Squarespace.DialogFields.Select({name:"custom-table-mobile-styles","strings.title":"Use Mobile Styles?","strings.description":"Choose and you will get optimized table layout on mobiles",defaultValue:s.mobileStyles?s.mobileStyles:"disabled",options:[{label:"Disabled",value:"disabled"},{label:"Stacked",value:"stacked"},{label:"Horizontally Scrolled",value:"horizontScroll"}]});L.after("dataChange",function(e){i()}),L.render(e.params.tabs[0].tabPanelObj);var A=new Y.Squarespace.DialogFields.Check({name:"custom-table-sort","strings.title":"Use Table Sorting?","strings.description":"If checked, you will get table sorting.",data:s.sortTable});A.after("dataChange",function(e){i()}),A.render(e.params.tabs[0].tabPanelObj);var E=new Y.Squarespace.DialogFields.Check({name:"custom-table-auto-detect-links","strings.title":"Autodetect links (links, emails, images)","strings.description":'If checked, plugins will replace things like https://google.com to <a target="_blank" href="https://google.com">https://google.com</a></br>Also, redirecting links from google will be stripped tp direct links.',data:s.autodetectLinks});E.after("dataChange",function(e){i()}),E.render(e.params.tabs[0].tabPanelObj);var M=new Y.Squarespace.DialogFields.Check({name:"custom-table-disable-markdown","strings.title":"Disable Markdown parsing.","strings.description":"If checked, markdown language is not rendered.",data:s.disableMarkdown});M.after("dataChange",function(e){i()}),M.render(e.params.tabs[0].tabPanelObj);var P=new Y.Squarespace.DialogFields.Description({name:"custom-import-description",className:"clear",title:"Import *.CSV",text:"Make sure your *.CSV file with comma ',' delimiter"});P.render(e.params.tabs[0].tabPanelObj);var B=new Y.Squarespace.DialogFields.Button({name:"custom-import-dataTable",className:"thin clear",onClick:function(){var e,t=function(){e&&(e.removeEventListener("change",o),e.parentNode&&e.parentNode.removeChild(e))},o=function(e){e=e.target.files;var o=new FileReader;o.onload=p,o.onabort=t,o.readAsText(e[0])};if(["File","FileReader","FileList","Blob"].every(function(e){return window[e]})){var r=document.createElement("input");r.setAttribute("type","file"),r.setAttribute("id","fileupload"),r.setAttribute("name","fileupload"),r.setAttribute("accept",".csv"),r.style.display="none",r.addEventListener("change",o),r.click(),e=r}else console.error("The File APIs are not fully supported in this browser.")},"strings.title":"Import *.CSV","strings.text":"IMPORT","strings.description":"Make sure your *.CSV file with comma ',' delimiter"});B.render(e.params.tabs[0].tabPanelObj);var O=new Y.Squarespace.DialogFields.DataTable({name:"custom-dataTable",height:200,"strings.title":"Table Data",data:s});O.after("dataChange",function(e){c=!1,i(e.newVal)}),O.populateTable=function(e){function t(e){return'<div class="drop-target-wrapper"><div class="'+e+'-drop-target"></div></div>'}var o=e.seriesLabels,r=e.labelName,a=e.sampleLabels;e=e.data;for(var n=this.get("oneDimension"),l=this.get("maxSeries"),s=this.get("maxSamples"),i="",c='<div class="corner-spacer data-table-header first-row cosmetic"><input id="labelName" type="text" value="'+Y.Escape.html(r)+'"></div>',d=Math.max(o.length+(n?0:1),4),u=0;u<d;u++)u<=o.length&&(c+=t("col")),c+=this._renderColHeader(u,o[u],o.length,l,n);for(4<=o.length&&(c+=t("col")),i+='<div class="data-table-row first-row">'+c+"</div>",l=0;l<e.length+1;l++)l<=e.length&&(i+=t("row")),i+=this._renderRow(l,e[l],a[l],o.length,e.length,s,n);o='<div class="inner-table">'+i+'</div><div class="trash-wrapper"><div class="chart-trash"><div class="chart-trash-content"></div></div></div>',this._table.setHTML(o),this.bindTable()},O.render(e.params.tabs[0].tabPanelObj),s.syncGSS||O.populateTable(s),O.readTable=function(){var e=[],t=[],o=[],r=O._table.one(".inner-table");r.all(".data-table-header").each(function(e){e.hasClass("cosmetic")||t.push(e.one("input").get("value"))}),r.all(".data-table-row").each(function(t){var r=0,a=[];t.all(".data-table-cell").each(function(e){e.hasClass("cosmetic")||(e=e.one("input").get("value"),0===r?(o.push(e),r++):a.push(e||""))}),0<r&&e.push(a)});var a={seriesLabels:t,sampleLabels:o,data:e,labelName:r.one("#labelName").get("value")};return a},i=a(function(e,t){e=e||O.get("data"),e.tableClasses=h.get("data"),e.tableDefClasses=g.get("data"),e.googleSync=q.get("data"),e.followGStyles=N.get("data"),e.googleKey=T.get("data"),e.autodetectLinks=E.getValue(),e.mobileStyles=L.get("data"),e.sortTable=A.get("data"),e.followTable=r,e.tableBack=f.get("data"),e.headerBack=k.get("data"),e.headerColor=y.get("data"),e.tableColor=_.get("data"),e.bordersColor=C.get("data"),e.disableMarkdown=M.get("data");var a=O.google_css;e.googleKey?O.hide():O.show(),c&&O.populateTable(e);var s=l(e,n);window.parseMarkdown&&!e.disableMarkdown&&(s=window.parseMarkdown(s));var i=S(e,n);i&&(s+=i);var d=n.get("id")&&"block-"+n.get("id");a=!!(a&&a.indexOf(".ritz ")>-1&&e.followGStyles)&&(".ritz "+a.split(/\.ritz (.+)/)[1]).replace(/\.ritz/g,"#"+d).replace(/\.waffle /g,'[data-follow-gss-styles="true"] '),a&&(a='<style id="google-styles-'+d+'">'+a+"</style>",s+=a),o&&o.setContent(s)},500,!1);var D=function(t){if(t){var o=w(t);if(o&&m(o)){T.set("data",o),e.showSaveOverlay();var r="?key="+o;o.indexOf("https:///")>-1&&(r="?url="+encodeURIComponent(o)),Y.io("https://tools.squarewebsites.org/api/gss-html/"+r+"&cache="+((new Date).getTime()+"").substr(0,8),{on:{success:function(t,o){e.hideSaveOverlay(),o&&o.responseText?p(o.responseText):(console.log("Malformed response."),new Y.Squarespace.Widgets.Alert({position:function(){return{top:Math.floor(T.get("contentBox").getY()),left:T.get("contentBox").getX()+100}},"strings.title":"Warning","strings.message":"Malformed response. Make sure this spreadsheet is public."}))},failure:function(t){e.hideSaveOverlay(),console.log(t),new Y.Squarespace.Widgets.Alert({position:function(){return{top:Math.floor(T.get("contentBox").getY()),left:T.get("contentBox").getX()+100}},"strings.title":"Warning","strings.message":error})}}})}else console.log("Can not parse Sheet key in this url"),new Y.Squarespace.Widgets.Alert({position:function(){return{top:Math.floor(T.get("contentBox").getY()),left:T.get("contentBox").getX()+100}},"strings.title":"Warning","strings.message":"Can't parse Sheet key in this url"})}};s.googleKey&&D(s.googleKey),i()}}};t?o():e.onceAfter("rendered",function(){o()}),window.customTable=!1}function S(e,t){if(!t)return console.log("No Block"),!1;var o="",a=t.get("id");return a?(e.tableBack&&(o+="#block-"+a+" tbody tr{background-color:"+e.tableBack+"}",o+="#block-"+a+" tbody {background-color:"+r(-.16,e.tableBack)+"}"),e.headerBack&&(o+="#block-"+a+" thead{background-color:"+e.headerBack+"}",o+="@media screen and (max-width: 768px) {#block-"+a+' table[data-mobile-styles]:not([data-mobile-styles="disabled"]) tbody td:before{background-color:'+e.headerBack+"}}"),e.headerColor&&(o+="#block-"+a+" thead{color:"+e.headerColor+"}",o+="@media screen and (max-width: 768px) {#block-"+a+' table[data-mobile-styles]:not([data-mobile-styles="disabled"]) tbody td:before{color:'+e.headerColor+"}}"),e.tableColor&&(o+="#block-"+a+" tbody{color:"+e.tableColor+"}"),e.bordersColor&&(o+="#block-"+a+" table{border-color:"+e.bordersColor+"}"),o.length?'<style class="table-stylesheet">'+o+"</style>":void 0):(console.log("Can't get id"),!1)}function C(e){if(e.style.width=null,e.style.height=null,e.style.top=null,e.style.left=null,e.style.right=null,e.style.bottom=null,e.childNodes.length>0)for(var t in e.childNodes)1===e.childNodes[t].nodeType&&C(e.childNodes[t])}function x(e){var t=document.createElement("div");t.innerHTML=e;var o=t.querySelector("table");if(o){C(o);var r=Array.prototype.slice.call(o.querySelectorAll("tbody tr"),0),a=r[0],n=a.querySelectorAll("td:not(.freezebar-cell)"),l=[],s=[];for(i=0;i<n.length;i++){var c=n[i].innerHTML;l.push(c)}for(r.splice(0,1),j=0;j<r.length;j++){var d=r[j].querySelectorAll("td:not(.freezebar-cell)"),u=[];for(k=0;k<d.length;k++){var p=d[k].innerHTML;u.push(p)}s.push(u)}return s.unshift(l),s}return!1}function T(t,o){t.classList.contains("sqs-layout-insert-block-menu")||(t=t.closest(".sqs-layout-insert-block-menu"));var r=e(t);r&&r.pendingProps&&!r.pendingProps.iconConfigs&&t.querySelector("section")&&(r=e(t.querySelector("section").parentNode));var a=t.ownerDocument.defaultView.Y,n=r&&r.stateNode&&r.stateNode.props||r&&r.pendingProps&&r.pendingProps.iconConfigs&&r.pendingProps||r&&r.pendingProps&&r.pendingProps.children&&r.pendingProps.children.props;if(r&&!t.addedTableIcon&&n&&n.iconConfigs){var l=null;for(var s in n.iconConfigs)n.iconConfigs.hasOwnProperty(s)&&n.iconConfigs[s].id&&"markdown"==n.iconConfigs[s].id&&(l=n.iconConfigs[s]);if(l){var i={value:{id:"custom-table",ctor:a.Base.create("block-custom-tables",a.SQS.LayoutEngine.Block.Markdown,[],{},{ATTRS:{defaultContentModel:{value:{wysiwyg:{engine:"code",mode:"markdown",isSource:!1,source:""},html:'<table class="custom-table-block custom-table-block-odd-rows custom-table-block-full-width custom-table-inited" data-def-classes="custom-table-block-odd-rows" data-auto-detect-links="true"></table>'}},editor:{valueFn:function(){return a.Squarespace.Block.Editor.Markdown}}}}),label:"Table",tags:["custom","table"]}};l.ctor;r.stateNode&&r.stateNode.props?(r.stateNode.props.iconConfigs&&(r.stateNode.props.iconConfigs[999]=i.value),r.stateNode.props.categories&&r.stateNode.props.categories[0].items.push(999)):r.pendingProps&&r.pendingProps.iconConfigs?(r.pendingProps.iconConfigs&&(r.pendingProps.iconConfigs[999]=i.value),r.pendingProps.categories&&r.pendingProps.categories[0].items.push(999)):r&&r.pendingProps&&r.pendingProps.children&&r.pendingProps.children.props&&(r.pendingProps.children.props.iconConfigs&&(r.pendingProps.children.props.iconConfigs[999]=i.value),r.pendingProps.children.props.categories&&r.pendingProps.children.props.categories[0].items.push(999)),r.stateNode&&r.stateNode.updater&&r.stateNode.updater.enqueueForceUpdate&&r.stateNode.updater.enqueueForceUpdate(r.stateNode),t.addedTableIcon=!0}}}function N(e){var t=e?e.Y:window.Y;t&&t.Squarespace&&t.Squarespace.Block&&t.Squarespace.Block.Editor?t.Squarespace.Block.Editor.Markdown.prototype._isCoalesceable=function(){return console.log("do not coalesce"),!1}:console.log("no block editor here"),t&&t&&t.SQS.LayoutEngine&&t.use(["@sqs/layout-engine/layout-editor","@sqs/layout-engine/layout-insert-block-menu-web-base"],function(e){if(t.SQS.LayoutEngine.Block&&t.SQS.LayoutEngine.Block.Markdown){var o={value:{id:"custom-table",ctor:t.Base.create("block-custom-tables",t.SQS.LayoutEngine.Block.Markdown,[],{},{ATTRS:{defaultContentModel:{value:{wysiwyg:{engine:"code",mode:"markdown",isSource:!1,source:""},html:'<table class="custom-table-block custom-table-block-odd-rows custom-table-block-full-width custom-table-inited" data-def-classes="custom-table-block-odd-rows" data-auto-detect-links="true"></table>'}},editor:{valueFn:function(){return t.Squarespace.Block.Editor.Markdown}}}}),label:"Table",tags:["custom","table"]}};if(t.SQS.LayoutEngine.Layout.InsertBlockMenuWebBase&&!t.SQS.LayoutEngine.Layout.InsertBlockMenuWebBase.prototype._customShow){t.SQS.LayoutEngine.Layout.InsertBlockMenuWebBase.prototype.initializer;t.SQS.LayoutEngine.Layout.InsertBlockMenuWebBase.prototype._customShow=!0;var r=t.SQS.LayoutEngine.Layout.InsertBlockMenuWebBase.prototype.getIconConfigs,a=t.SQS.LayoutEngine.Layout.InsertBlockMenuWebBase.prototype.renderReactBlockSelector;t.SQS.LayoutEngine.Layout.InsertBlockMenuWebBase.prototype.renderReactBlockSelector=function(){this._categories,this._iconConfigs;this._categories&&this._categories.length&&!this.tableCategoryAdded&&(this._categories[0].items.push(999),this.tableCategoryAdded=!0),a.apply(this,arguments)},t.SQS.LayoutEngine.Layout.InsertBlockMenuWebBase.prototype.getIconConfigs=function(){var e=r.apply(this,arguments),t=e[44];if(!e[999]&&t){var a=o.value;e[999]=a}return e}}}else console.log("Need Block Load");t.Squarespace.Block&&t.Squarespace.Block.Editor&&(t.Squarespace.Block.Editor.Markdown.prototype._isCoalesceable=function(){return!1})}),wind=e||window;var o=wind.document.body;!wind.BlocksMenuObserver&&o&&(wind.BlocksMenuObserver=new MutationObserver(function(e){e.forEach(function(e){if(e.target)e.target.className&&e.target.className.indexOf&&e.target.className.indexOf("sqs-layout-insert-block-menu")>-1?T(e.target,1):e.target.dataset&&"insert-block-menu"==e.target.dataset.test&&T(e.target,2);else if(e.addedNodes&&e.addedNodes[0]){var t=Array.prototype.slice.call(e.addedNodes[0].childNodes);if(e.addedNodes[0].className&&e.addedNodes[0].className.length)e.addedNodes[0].className.indexOf("sqs-layout-insert-block-menu")>-1&&T(e.target,3);else if(t[0]&&t[0].childNodes){var o=Array.prototype.slice.call(t[0].childNodes);o.forEach(function(t){t.className&&t.className.indexOf&&t.className.indexOf("sqs-layout-insert-block-menu")>-1&&T(e.target,4)})}}})}),wind.BlocksMenuObserver.observe(o,{childList:!0,subtree:!0,attributes:!0}))}function L(e,t,o){var r=document.createElement("link");r.href=e,r.rel="stylesheet",r.onload=function(){o&&o(null,{nodes:[this]})},t=t||document.getElementsByTagName("head")[0],t.appendChild(r)}function A(e){var t=e.closest(".sqs-block"),o=e.closest(".fluid-engine-block"),r=[];o&&o.querySelector(".custom-table-block")?r=o.querySelectorAll(".sqs-block-label-tag"):t&&t.querySelector(".custom-table-block")&&(r=t.querySelectorAll(".sqs-block-label-tag")),r&&r.length&&r.forEach(function(e){e.textContent="Table"})}function E(e){var t=e.document.querySelectorAll("body")[0];(e&&!e.__blockLabelObserver||e&&void 0===e.__blockLabelObserver)&&t&&(e.__blockLabelObserver=new MutationObserver(function(e){e.forEach(function(e){"childList"==e.type&&e.addedNodes[0]&&e.addedNodes[0].className&&e.addedNodes[0].className.length&&(e.addedNodes[0].className.indexOf("sqs-block-editor-button-container")>-1?window.top.__blockLabelsChecker.forEach(function(t){t(e.addedNodes[0])}):e.addedNodes[0].className.indexOf("sqs-block-label-tag")>-1&&A(e.addedNodes[0]))})}),e.__blockLabelObserver.observe(t,{childList:!0,subtree:!0}))}function M(e){return new Promise(function(t){var o=window.setInterval(function(){if(P(e))return window.clearInterval(o),t(!0)},20)})}function P(e){return e=e||window.top,e.Y&&e.Y.Squarespace&&e.Y.Squarespace.Block&&e.Y.Squarespace.Block.Editor&&e.Y.Squarespace.Block.Editor.Markdown&&e.Y.SQS&&e.Y.SQS.LayoutEngine&&e.Y.SQS.LayoutEngine.Layout&&e.Y.SQS.LayoutEngine.Layout.InsertBlockMenuWebBase}function B(){if(W&&(window.clearInterval(W),W=null),!window.custom_tables_inited){Y.Global.after("EditingDialog:show",y);var e=document.querySelector("#sqs-site-frame");E(window.top),N(),M(e.contentWindow).then(function(){N(e.contentWindow),E(e.contentWindow);try{Y.one("#sqs-site-frame")&&Y.one("#sqs-site-frame").on("load",function(t){N(e.contentWindow),E(e.contentWindow)})}catch(e){console.log(e)}}),window.top.document.querySelector(".squarespace-config")&&(window.top.document.getElementById("custom-tables-top")||L("../assets.squarewebsites.org/custom-tables/style.min.css",window.top.document.getElementsByTagName("head")[0],function(e,t){console.log("Custom Table CSS added"),t&&t.nodes[0].setAttribute("id","custom-tables-top")})),window.custom_tables_inited=!0,console.log("Custom Tables Admin init")}}var O=document.createElement("table"),D=document.createElement("tr"),F=document.createElement("th"),H=document.createElement("thead"),I=document.createElement("td");String.prototype.csvToArray=function(e){var t=function(e){var t=[",",";","|","\t"],o=t.map(function(t){return e.indexOf(t)}).reduce(function(e,t){return-1===e||-1!==t&&t<e?t:e});return e[o]||","},o={fSep:",",rSep:"\n",quot:'"',head:!1,trim:!1};if(e)for(var r in o)e[r]||(e[r]=o[r]);else e=o;var a=[[""]];e.fSep=t(this)||",",this.indexOf("\r\n")>-1&&(e.rSep="\r\n");for(var n=f=p=q=0;p<this.length;p++)switch(c=this.charAt(p)){case e.quot:q&&this.charAt(p+1)==e.quot?(a[n][f]+=e.quot,++p):q^=1;break;case e.fSep:q?a[n][f]+=c:(e.trim&&(a[n][f]=a[n][f].replace(/^\s\s*/,"").replace(/\s\s*$/,"")),a[n][++f]="");break;case e.rSep.charAt(0):q||e.rSep.charAt(1)&&(!e.rSep.charAt(1)||e.rSep.charAt(1)!=this.charAt(p+1))?a[n][f]+=c:(e.trim&&(a[n][f]=a[n][f].replace(/^\s\s*/,"").replace(/\s\s*$/,"")),a[++n]=[""],a[n][f=0]="",e.rSep.charAt(1)&&++p);break;default:a[n][f]+=c}return e.head&&a.shift(),a[a.length-1].length<a[0].length&&a.pop(),a};a(function(e,t){var o=t.target.get("blockIcon"),r=t.target.get("contentBox").one(".sqs-block-icon-container")||t.target.get("contentBox").one(".sqs-react-blockicon")&&t.target.get("contentBox").one(".sqs-react-blockicon").get("parentNode");t.target.get("editController").getRenderableBlocks(t.target.get("editMode"));if(r&&!r.one("#custom-table")){var a=new o(e);a.set("categoryLabel",t.target.item(1)),a.set("defaultContentModel",e.defaultContentModel),a.render(r),t.target._icons.push(a)}},200,!1);var W=!1;window.top.__blockLabelsChecker=window.top.__blockLabelsChecker&&window.top.__blockLabelsChecker.length?window.top.__blockLabelsChecker:[],window.top.__blockLabelsChecker.push(function(e){var t=e.parentNode,o=e.querySelector(".sqs-block-label-tag");t&&t.querySelector(".custom-table-block")&&o&&(o.textContent="Table")}),window.top.__sqs_custom_tables_inited||window.custom_tables_inited?console.log("Seems Custom Tables already initialized."):(window.__custom_tables_admin_init=function(e){P()&&(E(e),N(e),B())},P()?window.__custom_tables_admin_init(window.top):M().then(function(){window.__custom_tables_admin_init(window.top)}))}();